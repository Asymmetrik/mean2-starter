<section>

	<h3 class="page-header">
		Cache Entries
		<small>Administer Cache Entries</small>
	</h3>

	<!-- Alert Notifications -->
	<alert *ngFor="let alert of alertService.getAlerts(); let i = index" [type]="alert.type" (close)="alertService.clear(i)" dismissible="true" >{{alert.msg}}</alert>

	<!-- Search Input -->
	<div class="row">
		<div class="col-md-12">
			<div class="input-group">
				<input placeholder="Search key and value..." type="text" class="form-control input-sm" [(ngModel)]="search" (keyup.enter)="applySearch()">
				<span class="input-group-btn">
					<button class="btn btn-default btn-sm" type="button" (click)="applySearch()">
						<i class="fa fa-search"></i>
					</button>
				</span>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<!-- Sorting/Paging Controls -->
			<div [hidden]="pagingOpts.totalSize === 0">
				<div class="controls">
					<div class="paging-sort" style="float:left;">
						<span>Sort By:</span>
						<a type="button" [ngClass]="{selected: pagingOpts.sortField===sortOpts.key.sortField}" class="no-href btn-link" (click)="setSort(sortOpts.key)">Key</a> /
						<a type="button" [ngClass]="{selected: pagingOpts.sortField===sortOpts.timestamp.sortField}" class="no-href btn-link" (click)="setSort(sortOpts.timestamp)">Timestamp</a>
					</div>
					<div class="paging-controls pull-right">
						<asy-pager
								[pageNumber]="pagingOpts.pageNumber"
								[pageSize]="pagingOpts.pageSize"
								[totalSize]="pagingOpts.totalSize"
								[maxPageSize]="50"
								[currentSize]="cacheEntries.length"
								(onChange)="goToPage($event)">
						</asy-pager>
					</div>
				</div>
			</div>

		</div>

	</div>

	<div class="row">
		<div class="col-md-12">

			<!-- Actual results -->
			<table class="asymmetrik table table-condensed table-hover table-striped" [hidden]="cacheEntries.length === 0">
				<thead>
				<tr>
					<th>Key</th>
					<th>Value</th>
					<th>Timestamp</th>
					<th>&nbsp;</th>
				</tr>
				</thead>

				<tbody>
				<tr *ngFor="let cacheEntry of cacheEntries">
					<td>{{cacheEntry.entry.key}}</td>
					<td class="hideOverflow" style="max-width: 300px;">{{cacheEntry.entry.value | json}}</td>
					<td><span [attr.title]="cacheEntry.entry.ts | date:'yyyy-MM-dd HH:mm:ssZ'">{{cacheEntry.entry.ts | agoDate:false}}</span></td>
					<td style="width: 120px;">
						<div class="pull-right">
							<button title="View Entry" type="button" class="btn btn-default btn-sm" (click)="viewCacheEntry(cacheEntry)"><span class="fa fa-eye"></span></button>
							<button title="Refresh Entry" type="button" class="btn btn-default btn-sm" [disabled]="cacheEntry.isRefreshing" (click)="refreshCacheEntry(cacheEntry)"><span class="fa fa-refresh"></span></button>
							<button title="Delete Entry" type="button" class="btn btn-danger btn-sm" (click)="confirmDeleteEntry(cacheEntry)"><span class="fa fa-trash-o"></span></button>
						</div>
					</td>
				</tr>
				</tbody>
			</table>

			<div class="col-md-6 col-md-offset-3 center" [hidden]="cacheEntries.length > 0">
				<h3>
					<small>No Cache Entries matched your search</small>
				</h3>
			</div>

		</div>
	</div>

</section>